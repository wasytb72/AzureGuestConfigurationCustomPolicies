{
    "properties": {
        "displayName": "[Initiative] Guest Configuration Demo - Audit Windows Registry",
        "policyType": "Custom",
        "description": "Audit if a Windows Registry Key is in a desired state.",
        "metadata": {
            "category": "Guest Configuration"
        },
        "parameters": {
            "Verify Registry key for compliance": {
                "type": "string",
                "metadata": {
                    "displayName": "Windows registry key",
                    "description": "Name of the Registry Key"
                },
                "defaultValue": "HKEY_LOCAL_MACHINE\\SOFTWARE\\ExampleKey1",
                "allowedValues": [
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\ExampleKey1"
                ]
            }
        },
        "policyDefinitions": [
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bc9aa3e9-eb83-46cd-bfa3-ed34d4040036",
                "policyDefinitionReferenceId": "Deploy_AuditWindowsRegistry",
                "parameters": {
                    "Verify Registry key for compliance": {
                        "value": "[parameters('Verify Registry key for compliance')]"
                    }
                }
            },
            {
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dcd83c53-6abe-40f9-bace-8e20d270b90e",
                "policyDefinitionReferenceId": "Audit_AuditWindowsRegistry"
            }
        ]
    },
    "id": "/providers/Microsoft.Authorization/policySetDefinitions/1f52ec3d-09e7-4d42-9650-febec7773670",
    "name": "1f52ec3d-09e7-4d42-9650-febec7773670"
}